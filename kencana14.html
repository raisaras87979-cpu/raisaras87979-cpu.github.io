<!doctype html>
<html lang="id">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>KENCANA – Expected Impact (Live Donut)</title>

    <!-- Bootstrap 5 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet">
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
      rel="stylesheet">

    <!-- Chart.js -->
    <script
      src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <style>
    :root{
      --nav-w:255px;
      --cyan:#39c8e8;
      --line:rgba(255,255,255,.18);
      --text-dim:rgba(255,255,255,.75);
      --radius-xl:18px;

      --tbl-head:#0f5f82;
      --tbl-row:#e9ecef;
      --tbl-row-alt:#dfe3e7;
      --tbl-border:#c7cdd3;
    }

    body{
      background:
        radial-gradient(1200px 700px at 70% -10%, #1b4aa0 0%, transparent 60%),
        radial-gradient(1000px 800px at -10% 20%, #1a5a7a 0%, transparent 55%),
        linear-gradient(180deg, #0a1130 0%, #0d1f4a 50%, #0b1540 100%);
      min-height:100vh;
      color:#e8f2ff;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    }

    /* ===== Layout ===== */
    .app{
      display:grid;
      grid-template-columns: var(--nav-w) 1fr;
      grid-template-rows:auto 1fr;
      grid-template-areas:
        "sidebar topbar"
        "sidebar main";
      min-height:100vh;
    }

    /* ===== Sidebar ===== */
    .sidebar{
      grid-area:sidebar;
      position:sticky;top:0;height:100vh;
      padding:18px 14px;
      background:linear-gradient(180deg, rgba(10,20,47,.98) 0%, rgba(9,21,50,.98) 55%, rgba(8,16,40,1) 100%);
      border-right:1px solid var(--line);
      overflow:auto;z-index:20;
    }
    .brand{
      display:flex;align-items:center;gap:12px;
      padding:8px 8px 16px;border-bottom:1px solid var(--line);margin-bottom:14px;
    }
    .brand-mark{
      width:42px;height:42px;border-radius:10px;
      background:conic-gradient(from 220deg, var(--cyan), #6a7dff, #2ad1cf, var(--cyan));
      box-shadow:0 10px 20px rgba(30,200,230,.35);
    }
    .brand h1{
      font-size:16px;letter-spacing:.8px;margin:0;font-weight:800;color:#76e3ff;
    }
    .nav-group-title{
      font-size:12px;text-transform:uppercase;letter-spacing:1px;color:var(--text-dim);
      padding:10px 10px 6px;
    }
    .side-link{
      display:flex;align-items:center;justify-content:space-between;
      color:#e9f3ff;text-decoration:none;font-weight:600;font-size:14px;
      padding:10px 12px;border-radius:10px;margin:4px 0;
      border:1px solid transparent;background:transparent;transition:.15s ease;
    }
    .side-link .left{display:flex;align-items:center;gap:10px;}
    .side-link:hover{
      background:rgba(255,255,255,.05);border-color:rgba(255,255,255,.08);
      transform:translateX(2px);
    }
    .side-link.active{
      background:rgba(90,130,255,.18);
      border-color:rgba(90,130,255,.55);
      box-shadow:inset 0 0 0 1px rgba(255,255,255,.03);
    }
    .side-sep{height:1px;background:var(--line);margin:8px 4px;}
    .analysis-tabs{display:flex;gap:6px;padding:0 6px 8px;}
    .analysis-tabs .tab{
      flex:1;text-align:center;font-size:12px;font-weight:800;
      padding:8px 6px;border-radius:8px;border:1px solid var(--line);
      background:rgba(255,255,255,.04);color:#fff;
    }
    .analysis-tabs .tab.active{
      background:rgba(255,255,255,.12);border-color:rgba(255,255,255,.22);
    }
    .match-btn{
      width:100%;margin-top:6px;background:rgba(79,140,255,.15);
      border:1px solid rgba(79,140,255,.5);
      color:#e8f2ff;font-weight:800;border-radius:8px;padding:8px 10px;
    }

    /* ===== Topbar ===== */
    .topbar{
      grid-area:topbar;
      position:sticky;top:0;z-index:10;
      background:rgba(8,16,40,.7);backdrop-filter:blur(8px);
      border-bottom:1px solid var(--line);
      padding:10px 14px;display:flex;align-items:center;justify-content:flex-end;gap:10px;
    }
    .top-input{
      height:36px;background:rgba(255,255,255,.06);
      border:1px solid var(--line);color:#fff;font-weight:600;
    }
    .top-input::placeholder{color:rgba(255,255,255,.75);}
    .notif{
      width:38px;height:36px;display:grid;place-items:center;
      border:1px solid var(--line);background:rgba(255,255,255,.06);
      border-radius:6px;position:relative;
    }
    .notif .badge{position:absolute;top:-6px;right:-6px;}

    /* ===== Main ===== */
    main{grid-area:main;padding:18px;}
    .stage{
      background:linear-gradient(180deg, rgba(7,12,30,.92) 0%, rgba(16,44,92,.95) 60%, rgba(10,66,106,.98) 100%);
      border:1px solid var(--line);
      border-radius:var(--radius-xl);
      box-shadow:0 12px 28px rgba(0,0,0,.35);
      overflow:hidden;
      padding:14px;
    }

    /* Left table panel */
    .table-panel{
      background:rgba(8,16,40,.6);
      border:1px solid var(--line);
      border-radius:12px;
      overflow:hidden;
      height: 560px;
      display:flex;flex-direction:column;
    }
    .table-scroll{
      overflow:auto; flex:1;
      background: #cfd5db;
    }
    table.kencana{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
      font-weight:600;color:#101317;
    }
    table.kencana thead th{
      position:sticky; top:0; z-index:2;
      background:var(--tbl-head);
      color:#fff;font-size:14px;text-align:center;
      padding:10px 8px;border-right:1px solid rgba(255,255,255,.35);
      border-bottom:2px solid rgba(0,0,0,.25);
      letter-spacing:.3px;white-space:nowrap;
    }
    table.kencana thead th:last-child{border-right:none;}
    table.kencana tbody td{
      padding:12px 10px;vertical-align:middle;
      border-right:1px solid var(--tbl-border);
      border-bottom:1px solid var(--tbl-border);
      background:var(--tbl-row);font-weight:600;
    }
    table.kencana tbody tr:nth-child(even) td{background:var(--tbl-row-alt);}
    table.kencana tbody td:last-child{border-right:none;}
    .date-cell{width:190px;}
    .impact-cell{width:140px;text-align:center;}
    .detail-cell{width:90px;text-align:center;}

    .impact-badge{
      width:22px;height:18px;border-radius:2px;display:inline-block;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.25), 0 2px 6px rgba(0,0,0,.2);
    }
    .i-red{background:#ff1f1f;}
    .i-orange{background:#f39c12;}
    .i-yellow{background:#ffe600;}
    .i-gray{background:#e5e5e5;}

    .detail-icon{
      width:26px;height:20px;border-radius:3px;display:inline-grid;place-items:center;
      background:linear-gradient(180deg,#ffe08a,#f7b550);
      border:1px solid rgba(0,0,0,.25);
      color:#6b3c00;font-size:12px;font-weight:900;
    }

    /* Right Expected Impact panel */
    .impact-panel{
      background:linear-gradient(180deg, #0aa7e7 0%, #0b8bcb 40%, #0a6fb2 100%);
      border:1px solid rgba(255,255,255,.35);
      border-radius:12px;
      height:560px;
      padding:14px 14px 12px;
      color:#eaffff;
      display:flex;flex-direction:column;gap:10px;
    }
    .impact-title{
      text-align:center;font-weight:900;letter-spacing:.6px;font-size:15px;
    }

    .chart-box{
      display:grid;place-items:center;
      padding:6px 0 2px;
    }
    .chart-shell{
      width:250px;height:250px;
      background: radial-gradient(circle at 50% 50%, rgba(255,255,255,.08), transparent 60%);
      border-radius:50%;
      display:grid;place-items:center;
      box-shadow:0 12px 24px rgba(0,0,0,.3);
      position:relative;
    }
    canvas{max-width:240px !important; max-height:240px !important;}

    .legend-box{
      background:rgba(7,18,40,.6);
      border:1px solid rgba(255,255,255,.35);
      border-radius:10px;
      padding:10px;
      display:flex;flex-direction:column;gap:8px;
      font-size:13px;font-weight:700;
    }
    .legend-item{display:flex;align-items:center;gap:8px;}

    .legend-swatch{
      width:18px;height:12px;border-radius:2px;flex:0 0 auto;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.25);
    }

    .impact-actions{
      margin-top:auto;display:grid;gap:8px;
    }
    .btn-apply{
      background:linear-gradient(180deg,#77e4ff,#1fb0e8);
      border:none;color:#003248;font-weight:900;letter-spacing:.6px;
      padding:8px;border-radius:0;
      box-shadow: inset 0 -2px 0 rgba(0,0,0,.25);
    }
    .btn-cancel{
      background:transparent;border:1px solid rgba(255,255,255,.65);
      color:#fff;font-weight:800;letter-spacing:.4px;
      padding:7px;border-radius:0;
    }

    /* Mobile sidebar */
    .menu-btn{
      display:none;position:fixed;top:12px;left:12px;z-index:50;
      width:40px;height:40px;border-radius:10px;
      background:rgba(8,16,40,.9);
      border:1px solid var(--line);
      color:#fff;font-size:20px;font-weight:700;
    }
    @media (max-width:992px){
      :root{--nav-w:230px;}
      .table-panel,.impact-panel{height:520px;}
    }
    @media (max-width:768px){
      .app{grid-template-columns:1fr;grid-template-areas:"topbar" "main";}
      .sidebar{
        position:fixed;inset:0 auto 0 0;width:var(--nav-w);
        transform:translateX(-105%);transition:.2s ease;z-index:40;
      }
      .sidebar.open{transform:translateX(0);}
      .menu-btn{display:grid;place-items:center;}
      .topbar{justify-content:center;padding-left:60px;}
      .table-panel,.impact-panel{height:auto;min-height:420px;}
    }
  </style>
  </head>
  <body>

    <button class="menu-btn" id="menuBtn">☰</button>

    <div class="app">

      <!-- SIDEBAR -->
      <aside class="sidebar" id="sidebar">
        <div class="brand">
          <div class="brand-mark"></div>
          <div>
            <img src="logoikencana.png" width="200px">
          </div>
        </div>

        <a class="side-link" href="dashboard.html"><div class="left"><i
              class="bi bi-house"></i> Home</div></a>
        <div class="side-sep"></div>

        <div class="nav-group-title">Umum</div>
        <a class="side-link active" href="#"><div class="left"><i
              class="bi bi-people"></i> Klasifikasi Personnel</div></a>
        <a class="side-link" href="#"><div class="left"><i
              class="bi bi-person-badge"></i> Klasifikasi Jabatan</div></a>

        <div class="side-sep"></div>

        <div class="nav-group-title">Spesifik</div>
        <a class="side-link" href="#"><div class="left"><i
              class="bi bi-mortarboard"></i> Klasifikasi Pendidikan</div></a>
        <a class="side-link" href="#"><div class="left"><i
              class="bi bi-stars"></i> Klasifikasi Khusus</div></a>

        <div class="side-sep"></div>

        <div class="nav-group-title">Analysis Alokasi</div>
        <div class="analysis-tabs">
          <div class="tab">Jabatan</div>
          <div class="tab active">Personnel</div>
        </div>
        <button class="match-btn">Match Checking</button>

        <div class="mt-auto pt-5">
          <a class="side-link" href="#"><div class="left"><i
                class="bi bi-box-arrow-right"></i> Log Out</div></a>
        </div>
      </aside>

      <!-- TOPBAR -->
      <header class="topbar">
        <div class="input-group" style="max-width:260px;">
          <span
            class="input-group-text bg-transparent border-0 text-white-50 fw-bold">Kategori</span>
          <select class="form-select top-input">
            <option selected>All</option>
            <option>Angkatan</option>
            <option>Pangkat</option>
          </select>
        </div>

        <div class="input-group" style="max-width:320px;">
          <span
            class="input-group-text bg-transparent border-0 text-white-50 fw-bold">Cari</span>
          <input class="form-control top-input" placeholder="Search..." />
          <span class="input-group-text bg-transparent border-0 text-white-50">
            <i class="bi bi-search"></i>
          </span>
        </div>

        <div class="notif">
          <i class="bi bi-bell"></i>
          <span class="badge rounded-pill text-bg-danger">3</span>
        </div>
      </header>

      <!-- MAIN -->
      <main>
        <section class="stage">
          <div class="row g-3">

            <!-- TABLE LEFT -->
            <div class="col-12 col-lg-8">
              <div class="table-panel">
                <div class="table-scroll">
                  <table class="kencana">
                    <thead>
                      <tr>
                        <th class="date-cell">Date</th>
                        <th class="impact-cell">Impact <i
                            class="bi bi-caret-down-fill ms-1"></i></th>
                        <th>Keterangan</th>
                        <th class="detail-cell">Detail</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td class="date-cell">Selasa,<br>21 Mei 2024</td>
                        <td class="impact-cell"><span
                            class="impact-badge i-red"></span></td>
                        <td>Kasubdis BMN Disbekal</td>
                        <td class="detail-cell"><span
                            class="detail-icon">★</span></td>
                      </tr>
                      <tr>
                        <td>Rabu,<br>22 Mei 2024</td>
                        <td class="impact-cell"><span
                            class="impact-badge i-red"></span></td>
                        <td>Kasubdis Matkaban Dismatal</td>
                        <td class="detail-cell"><span
                            class="detail-icon">★</span></td>
                      </tr>
                      <tr>
                        <td>Rabu,<br>22 Mei 2024</td>
                        <td class="impact-cell"><span
                            class="impact-badge i-red"></span></td>
                        <td>Pasharmat Satsel Koarmada II</td>
                        <td class="detail-cell"><span
                            class="detail-icon">★</span></td>
                      </tr>
                      <tr>
                        <td>Kamis,<br>23 Mei 2024</td>
                        <td class="impact-cell"><span
                            class="impact-badge i-orange"></span></td>
                        <td>Dirlog AAL</td>
                        <td class="detail-cell"><span
                            class="detail-icon">⧉</span></td>
                      </tr>
                      <tr>
                        <td>Kamis,<br>23 Mei 2024</td>
                        <td class="impact-cell"><span
                            class="impact-badge i-orange"></span></td>
                        <td>Kabid Matra Laut Kemenhan</td>
                        <td class="detail-cell"><span
                            class="detail-icon">⧉</span></td>
                      </tr>
                      <tr>
                        <td>Kamis,<br>23 Mei 2024</td>
                        <td class="impact-cell"><span
                            class="impact-badge i-yellow"></span></td>
                        <td>Letkol Laut (T) Tony Yuliantoro</td>
                        <td class="detail-cell"><span
                            class="detail-icon">⧉</span></td>
                      </tr>
                      <tr>
                        <td>Jumat,<br>24 Mei 2024</td>
                        <td class="impact-cell"><span
                            class="impact-badge i-yellow"></span></td>
                        <td>Letkol Laut (T) Herawan Kasbullah</td>
                        <td class="detail-cell"><span
                            class="detail-icon">★</span></td>
                      </tr>
                      <tr>
                        <td>Jumat,<br>24 Mei 2024</td>
                        <td class="impact-cell"><span
                            class="impact-badge i-gray"></span></td>
                        <td>Kabagminpers Dislaikmatal</td>
                        <td class="detail-cell"><span
                            class="detail-icon">★</span></td>
                      </tr>

                      <!-- filler rows for scroll feel -->
                      <tr><td>Senin,<br>27 Mei 2024</td><td
                          class="impact-cell"><span
                            class="impact-badge i-orange"></span></td><td>Contoh
                          Keterangan Tambahan</td><td class="detail-cell"><span
                            class="detail-icon">⧉</span></td></tr>
                      <tr><td>Selasa,<br>28 Mei 2024</td><td
                          class="impact-cell"><span
                            class="impact-badge i-red"></span></td><td>Contoh
                          Keterangan Tambahan</td><td class="detail-cell"><span
                            class="detail-icon">★</span></td></tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <!-- EXPECTED IMPACT RIGHT -->
            <div class="col-12 col-lg-4">
              <aside class="impact-panel">
                <div class="impact-title">EXPECTED IMPACT</div>

                <div class="chart-box">
                  <div class="chart-shell">
                    <canvas id="impactChart" width="240" height="240"></canvas>
                  </div>
                </div>

                <div class="legend-box" id="legendBox">
                  <label class="legend-item form-check">
                    <input class="form-check-input me-2 impact-toggle"
                      type="checkbox" data-index="0" checked>
                    <span class="legend-swatch me-2"
                      style="background:#ff1f1f"></span>
                    <span>Personel alert &gt; 2 Th</span>
                  </label>

                  <label class="legend-item form-check">
                    <input class="form-check-input me-2 impact-toggle"
                      type="checkbox" data-index="1" checked>
                    <span class="legend-swatch me-2"
                      style="background:#f39c12"></span>
                    <span>Personel alert 1 s.d 2 Th</span>
                  </label>

                  <label class="legend-item form-check">
                    <input class="form-check-input me-2 impact-toggle"
                      type="checkbox" data-index="2" checked>
                    <span class="legend-swatch me-2"
                      style="background:#ffe600"></span>
                    <span>Personel Promotion Eligible</span>
                  </label>

                  <label class="legend-item form-check">
                    <input class="form-check-input me-2 impact-toggle"
                      type="checkbox" data-index="3" checked>
                    <span class="legend-swatch me-2"
                      style="background:#e5e5e5"></span>
                    <span>Empty Slot Position</span>
                  </label>
                </div>

                <div class="impact-actions">
                  <button class="btn btn-apply" id="applyBtn">APPLY</button>
                  <button class="btn btn-cancel" id="cancelBtn">CANCEL</button>
                </div>
              </aside>
            </div>
          </div>
        </section>
      </main>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
  // Sidebar mobile toggle
  const sidebar = document.getElementById('sidebar');
  const menuBtn = document.getElementById('menuBtn');
  menuBtn?.addEventListener('click', ()=> sidebar.classList.toggle('open'));
  document.addEventListener('click', (e)=>{
    if (!window.matchMedia("(max-width: 768px)").matches) return;
    if (sidebar.classList.contains('open') && !sidebar.contains(e.target) && e.target !== menuBtn){
      sidebar.classList.remove('open');
    }
  });

  // ===== Chart.js Donut =====
  const ctx = document.getElementById('impactChart');

  const impactData = {
    labels: [
      'Personel alert > 2 Th',
      'Personel alert 1 s.d 2 Th',
      'Personel Promotion Eligible',
      'Empty Slot Position'
    ],
    values: [89, 55, 76, 32], // from screenshot
    colors: ['#ff1f1f', '#f39c12', '#ffe600', '#e5e5e5']
  };

  // Plugin to draw numeric labels on arcs
  const arcLabels = {
    id: 'arcLabels',
    afterDatasetsDraw(chart) {
      const {ctx} = chart;
      const meta = chart.getDatasetMeta(0);
      const data = chart.data.datasets[0].data;

      ctx.save();
      ctx.font = '700 12px system-ui, sans-serif';
      ctx.fillStyle = '#0b0f14';

      meta.data.forEach((arc, i) => {
        if (chart.getDataVisibility(i) === false) return;
        const p = arc.tooltipPosition();
        ctx.fillText(data[i], p.x - 6, p.y + 4);
      });
      ctx.restore();
    }
  };

  const chart = new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: impactData.labels,
      datasets: [{
        data: impactData.values,
        backgroundColor: impactData.colors,
        borderWidth: 0,
        hoverOffset: 6
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      cutout: '55%',
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(8,16,40,.95)',
          titleColor: '#fff',
          bodyColor: '#dfefff',
          borderColor: 'rgba(255,255,255,.18)',
          borderWidth: 1,
          padding: 10,
          callbacks: {
            label: (ctx) => ` ${ctx.label}: ${ctx.raw}`
          }
        }
      }
    },
    plugins: [arcLabels]
  });

  // Checkbox -> hide/show arc
  document.querySelectorAll('.impact-toggle').forEach(cb => {
    cb.addEventListener('change', (e) => {
      const i = Number(e.target.dataset.index);
      chart.toggleDataVisibility(i);
      chart.update();
    });
  });

  // Apply / Cancel (demo handlers)
  document.getElementById('applyBtn').addEventListener('click', () => {
    // in real app: send selected states to backend / filter table
    const active = [...document.querySelectorAll('.impact-toggle')]
      .filter(x => x.checked)
      .map(x => impactData.labels[Number(x.dataset.index)]);
    alert('Applied filters:\n- ' + active.join('\n- '));
  });

  document.getElementById('cancelBtn').addEventListener('click', () => {
    // reset all
    document.querySelectorAll('.impact-toggle').forEach((cb, i) => {
      cb.checked = true;
      chart.setDataVisibility(i, true);
    });
    chart.update();
  });
</script>

  </body>
</html>
